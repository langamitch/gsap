<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ad Posting Payment Form</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 600px;
            margin: 20px auto;
            padding: 20px;
            background-color: #f9f9f9;
        }
        .form-container {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .form-step {
            display: none;
        }
        .form-step.active {
            display: block;
        }
        .form-group {
            margin-bottom: 15px;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        input, select, textarea {
            width: 100%;
            padding: 8px;
            border: 1px solid #ccc;
            border-radius: 4px;
            box-sizing: border-box;
        }
        textarea {
            resize: vertical;
            min-height: 100px;
        }
        .error {
            color: red;
            font-size: 0.9em;
            display: none;
        }
        button {
            background-color: #28a745;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        button:disabled {
            background-color: #ccc;
            cursor: not-allowed;
        }
        .loader {
            display: none;
            border: 4px solid #f3f3f3;
            border-top: 4px solid #28a745;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            animation: spin 1s linear infinite;
            margin: 10px auto;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .progress-bar {
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            text-align: center;
        }
        .progress-step {
            flex: 1;
            padding: 10px;
            background: #e0e0e0;
            color: #666;
            border-radius: 4px;
            margin: 0 5px;
        }
        .progress-step.active {
            background: #28a745;
            color: white;
        }
        .pricing-summary {
            background: #f1f1f1;
            padding: 15px;
            border-radius: 4px;
            margin-bottom: 15px;
        }
    </style>
</head>
<body>
    <div class="form-container">
        <div class="progress-bar">
            <div class="progress-step active" id="step-1">Ad Details</div>
            <div class="progress-step" id="step-2">User Info</div>
            <div class="progress-step" id="step-3">Pricing</div>
            <div class="progress-step" id="step-4">Payment</div>
            <div class="progress-step" id="step-5">Confirm</div>
        </div>

        <form id="adPaymentForm">
            <!-- Step 1: Ad Details -->
            <div class="form-step active" id="ad-details">
                <h2>Ad Details</h2>
                <div class="form-group">
                    <label for="ad-title">Ad Title</label>
                    <input type="text" id="ad-title" name="ad-title" required>
                    <span class="error" id="ad-title-error">Please enter an ad title</span>
                </div>
                <div class="form-group">
                    <label for="ad-description">Ad Description</label>
                    <textarea id="ad-description" name="ad-description" required></textarea>
                    <span class="error" id="ad-description-error">Please enter a description</span>
                </div>
                <div class="form-group">
                    <label for="category">Category</label>
                    <select id="category" name="category" required>
                        <option value="">Select Category</option>
                        <option value="electronics">Electronics</option>
                        <option value="vehicles">Vehicles</option>
                        <option value="real-estate">Real Estate</option>
                        <option value="services">Services</option>
                    </select>
                    <span class="error" id="category-error">Please select a category</span>
                </div>
                <div class="form-group">
                    <label for="ad-image">Image Upload (Optional)</label>
                    <input type="file" id="ad-image" name="ad-image" accept="image/*">
                </div>
                <div class="form-group">
                    <label>Ad Duration</label>
                    <select id="ad-duration" name="ad-duration" required>
                        <option value="7">7 Days ($10)</option>
                        <option value="30">30 Days ($25)</option>
                        <option value="60">60 Days ($45)</option>
                    </select>
                    <span class="error" id="ad-duration-error">Please select a duration</span>
                </div>
                <div class="form-group">
                    <label for="location">Location/Region (Optional)</label>
                    <input type="text" id="location" name="location">
                </div>
                <button type="button" onclick="nextStep(1)">Next</button>
            </div>

            <!-- Step 2: User Information -->
            <div class="form-step" id="user-info">
                <h2>User Information</h2>
                <div class="form-group">
                    <label for="full-name">Full Name</label>
                    <input type="text" id="full-name" name="full-name" required>
                    <span class="error" id="full-name-error">Please enter your full name</span>
                </div>
                <div class="form-group">
                    <label for="email">Email Address</label>
                    <input type="email" id="email" name="email" required>
                    <span class="error" id="email-error">Please enter a valid email address</span>
                </div>
                <div class="form-group">
                    <label for="phone">Phone Number (Optional)</label>
                    <input type="tel" id="phone" name="phone">
                </div>
                <button type="button" onclick="prevStep(2)">Back</button>
                <button type="button" onclick="nextStep(2)">Next</button>
            </div>

            <!-- Step 3: Pricing Summary -->
            <div class="form-step" id="pricing-summary">
                <h2>Pricing Summary</h2>
                <div class="pricing-summary">
                    <p><strong>Ad Title:</strong> <span id="summary-title"></span></p>
                    <p><strong>Category:</strong> <span id="summary-category"></span></p>
                    <p><strong>Duration:</strong> <span id="summary-duration"></span></p>
                    <p><strong>Location:</strong> <span id="summary-location"></span></p>
                    <p><strong>Price:</strong> $<span id="summary-price">0</span></p>
                    <div class="form-group">
                        <label for="promo-code">Promo Code (Optional)</label>
                        <input type="text" id="promo-code" name="promo-code">
                        <button type="button" onclick="applyPromo()">Apply</button>
                        <span id="promo-error" class="error"></span>
                    </div>
                </div>
                <button type="button" onclick="prevStep(3)">Back</button>
                <button type="button" onclick="nextStep(3)">Next</button>
            </div>

            <!-- Step 4: Payment Method -->
            <div class="form-step" id="payment-method">
                <h2>Payment Method</h2>
                <div class="form-group">
                    <label for="card-number">Card Number</label>
                    <input type="text" id="card-number" name="card-number" maxlength="19" required>
                    <span class="error" id="card-number-error">Please enter a valid card number</span>
                </div>
                <div class="form-group">
                    <label for="expiry-date">Expiry Date (MM/YY)</label>
                    <input type="text" id="expiry-date" name="expiry-date" placeholder="MM/YY" required>
                    <span class="error" id="expiry-date-error">Please enter a valid expiry date</span>
                </div>
                <div class="form-group">
                    <label for="cvv">CVV</label>
                    <input type="text" id="cvv" name="cvv" maxlength="4" required>
                    <span class="error" id="cvv-error">Please enter a valid CVV</span>
                </div>
                <div class="form-group">
                    <label for="cardholder-name">Cardholder Name</label>
                    <input type="text" id="cardholder-name" name="cardholder-name" required>
                    <span class="error" id="cardholder-name-error">Please enter the cardholder name</span>
                </div>
                <div class="form-group">
                    <label>Other Payment Options</label><br>
                    <button type="button" onclick="alert('Redirecting to PayPal...')">Pay with PayPal</button>
                    <button type="button" onclick="alert('Redirecting to Stripe...')">Pay with Stripe</button>
                </div>
                <button type="button" onclick="prevStep(4)">Back</button>
                <button type="button" onclick="nextStep(4)">Next</button>
            </div>

            <!-- Step 5: Confirmation & Agreement -->
            <div class="form-step" id="confirmation">
                <h2>Confirmation</h2>
                <div class="form-group">
                    <label>
                        <input type="checkbox" id="terms" name="terms" required>
                        I agree to the <a href="/terms" target="_blank">Terms & Conditions</a> and <a href="/refund" target="_blank">Refund Policy</a>
                    </label>
                    <span class="error" id="terms-error">You must agree to the terms</span>
                </div>
                <div class="form-group">
                    <label>
                        <input type="checkbox" id="save-payment" name="save-payment">
                        Save payment information for future use
                    </label>
                </div>
                <div class="form-group">
                    <h3>Ad Preview</h3>
                    <div style="border: 1px solid #ccc; padding: 10px; border-radius: 4px;">
                        <h4 id="preview-title"></h4>
                        <p id="preview-description"></p>
                        <p><strong>Category:</strong> <span id="preview-category"></span></p>
                        <p><strong>Duration:</strong> <span id="preview-duration"></span></p>
                    </div>
                </div>
                <button type="button" onclick="prevStep(5)">Back</button>
                <button type="submit" id="submit-btn">Pay & Post Ad</button>
                <div class="loader" id="loader"></div>
            </div>
        </form>
    </div>

    <script>
        let currentStep = 1;
        const formData = {};

        function showStep(step) {
            document.querySelectorAll('.form-step').forEach(step => step.classList.remove('active'));
            document.getElementById(['ad-details', 'user-info', 'pricing-summary', 'payment-method', 'confirmation'][step - 1]).classList.add('active');
            document.querySelectorAll('.progress-step').forEach(step => step.classList.remove('active'));
            document.getElementById(`step-${step}`).classList.add('active');
            currentStep = step;
        }

        function validateStep(step) {
            let valid = true;
            const fields = {
                1: ['ad-title', 'ad-description', 'category', 'ad-duration'],
                2: ['full-name', 'email'],
                4: ['card-number', 'expiry-date', 'cvv', 'cardholder-name'],
                5: ['terms']
            };

            if (fields[step]) {
                fields[step].forEach(field => {
                    const input = document.getElementById(field);
                    const error = document.getElementById(`${field}-error`);
                    if (!input.value || (field === 'email' && !input.value.includes('@')) || 
                        (field === 'card-number' && input.value.replace(/\s/g, '').length < 16) ||
                        (field === 'expiry-date' && !/^\d{2}\/\d{2}$/.test(input.value)) ||
                        (field === 'cvv' && input.value.length < 3)) {
                        error.style.display = 'block';
                        valid = false;
                    } else {
                        error.style.display = 'none';
                        formData[field] = input.value;
                    }
                });
            }
            return valid;
        }

        function nextStep(step) {
            if (validateStep(step)) {
                if (step === 3) {
                    updatePricingSummary();
                } else if (step === 5) {
                    updatePreview();
                }
                showStep(step + 1);
            }
        }

        function prevStep(step) {
            showStep(step - 1);
        }

        function updatePricingSummary() {
            document.getElementById('summary-title').textContent = formData['ad-title'] || 'N/A';
            document.getElementById('summary-category').textContent = formData['category'] || 'N/A';
            document.getElementById('summary-duration').textContent = formData['ad-duration'] + ' Days' || 'N/A';
            document.getElementById('summary-location').textContent = document.getElementById('location').value || 'N/A';
            const priceMap = { '7': 10, '30': 25, '60': 45 };
            document.getElementById('summary-price').textContent = priceMap[formData['ad-duration']] || 0;
        }

        function updatePreview() {
            document.getElementById('preview-title').textContent = formData['ad-title'] || 'N/A';
            document.getElementById('preview-description').textContent = formData['ad-description'] || 'N/A';
            document.getElementById('preview-category').textContent = formData['category'] || 'N/A';
            document.getElementById('preview-duration').textContent = formData['ad-duration'] + ' Days' || 'N/A';
        }

        function applyPromo() {
            const promoCode = document.getElementById('promo-code').value;
            const promoError = document.getElementById('promo-error');
            // Mock promo code validation
            if (promoCode === 'SAVE10') {
                const price = parseInt(document.getElementById('summary-price').textContent);
                document.getElementById('summary-price').textContent = price * 0.9;
                promoError.textContent = 'Promo applied!';
                promoError.style.color = 'green';
                promoError.style.display = 'block';
            } else {
                promoError.textContent = 'Invalid promo code';
                promoError.style.color = 'red';
                promoError.style.display = 'block';
            }
        }

        document.getElementById('adPaymentForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            if (validateStep(5)) {
                const submitBtn = document.getElementById('submit-btn');
                const loader = document.getElementById('loader');
                submitBtn.disabled = true;
                loader.style.display = 'block';

                // Simulate payment processing
                setTimeout(() => {
                    loader.style.display = 'none';
                    alert('Payment successful! Ad posted. A confirmation email has been sent to ' + formData['email']);
                    // Reset form
                    document.getElementById('adPaymentForm').reset();
                    showStep(1);
                    submitBtn.disabled = false;
                }, 2000);

                // For real payment integration (e.g., Stripe):
                /*
                const stripe = Stripe('your-publishable-key');
                const { error } = await stripe.redirectToCheckout({
                    // Configure Stripe Checkout session
                });
                if (error) {
                    alert('Payment failed: ' + error.message);
                    submitBtn.disabled = false;
                    loader.style.display = 'none';
                }
                */
            }
        });

        // Real-time card number formatting
        document.getElementById('card-number').addEventListener('input', (e) => {
            let value = e.target.value.replace(/\D/g, '');
            value = value.match(/.{1,4}/g)?.join(' ') || value;
            e.target.value = value;
        });

        // Real-time expiry date formatting
        document.getElementById('expiry-date').addEventListener('input', (e) => {
            let value = e.target.value.replace(/\D/g, '');
            if (value.length > 2) {
                value = value.slice(0, 2) + '/' + value.slice(2, 4);
            }
            e.target.value = value;
        });
    </script>
</body>
</html>